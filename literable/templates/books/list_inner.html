<div class="row row-library" data-book-id="{{ book.id }}">
    <div class="span1 cell-cover">
        <img src="{{ book.get_thumb_url() }}" />
        {% if reading_list %}
            <div class="reading-list-reposition" title="Click and drag to reorder">
                <i class="icon-move"></i>
            </div>
        {% endif %}
    </div>

    <div class="span8 cell-info">
        <h3>{{ book.title | safe }}</h3>
        {% if book.series %}
            <div class="book-series">
                <a href="{{ url_for('series', series=book.series.slug) }}">
                    <span class="label label-info">{{ book.series.title }}</span></a>
                {% if book.series_seq %}
                    <span class="seq label">Book {{ book.series_seq }}</span>
                {% endif %}
            </div>
        {% endif %}

        <h4 class="author">
            <a href="{{ url_for('author', author=book.author.slug) }}">
                {{ book.author.name }}
            </a>
        </h4>

        {% if book.description %}
            <div class="description">
                {% if not search and len(book.description) > 50 %}
                    <p class="description-summary">
                        {{ book.description | truncate(150) }}
                        <a href="javascript:void(0);" class="collapse-description" data-toggle="collapse" data-target="#description-{{ book.id }}">more</a>
                    </p>
                    <div id="description-{{ book.id }}" class="collapsible collapse">
                        {{ book.description | markdown }}
                    </div>
                {% else %}
                    {{ book.description | markdown }}
                {% endif %}
            </div>
        {% endif %}

        {% if book.genre %}
            <div class="book-genre">
                <i class="icon-folder-open"></i>
                {% for genre in book.genre.get_parents() %}
                    <a href="{{ url_for('genre', genre=genre.slug) }}">{{ genre.name }}</a>
                    <i class="icon-chevron-right"></i>
                {% endfor %}
                <a href="{{ url_for('genre', genre=book.genre.slug) }}">{{ book.genre.name }}</a>
            </div>
        {% endif %}

        {% if book.tags %}
            <ul class="book-tags">
                <li><i class="icon-tags"></i></li>
                {% for tag in book.tags %}
                    <li>
                        <a href="{{ url_for('tag', tag=tag.slug) }}">{{ tag.name }}</a>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    <div class="span2 cell-actions">
        <p><a href="{{ url_for('download_book', id=book.id) }}" class="btn"><i class="icon-download-alt"></i> {{ book.get_format() }}</a></p>
        <p><a href="{{ url_for('edit_book', id=book.id) }}" class="btn"><i class="icon-edit"></i> Edit</a></p>
        {% if reading_list %}
            <p><a href="javascript:void(0);" class="btn remove-from-reading-list" data-book-id="{{ book.id }}"><i class="icon-list"></i> Remove</a></p>
        {% elif not is_book_in_reading_list(book.id) %}
            <p><a href="javascript:void(0);" class="btn add-to-reading-list" data-book-id="{{ book.id }}"><i class="icon-list"></i> To List</a></p>
        {% else %}
            <p><a href="javascript:void(0);" class="btn btn-success" disabled="disabled"><i class="icon-ok icon-white"></i> In List</a></p>
        {% endif %}
        <p><a class="btn btn-danger warn" data-warning="Are you sure you want to delete this book? This action is irrevocable." href="{{ url_for('delete_book', id=book.id, next=request.path) }}"><i class="icon-trash icon-white"></i> Delete</a></p>
        <div class="rating" data-book-id="{{ book.id }}" data-score="{{ book.rating }}"></div>
    </div>
</div>